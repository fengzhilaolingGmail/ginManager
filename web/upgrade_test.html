<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Layui升级验证测试</title>
    <link rel="stylesheet" href="lib/layui-v2.13.2/css/layui.css" media="all">
</head>
<body>
    <div class="layui-container" style="margin-top: 20px;">
        <div class="layui-row">
            <div class="layui-col-md12">
                <div class="layui-card">
                    <div class="layui-card-header">
                        <h2>Layui v2.6.3 → v2.13.2 升级验证</h2>
                    </div>
                    <div class="layui-card-body">
                        <table class="layui-table">
                            <colgroup>
                                <col width="200">
                                <col width="200">
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>检测项目</th>
                                    <th>状态</th>
                                    <th>详情</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Layui版本</td>
                                    <td><span id="version-status" class="layui-badge">检测中</span></td>
                                    <td id="version-detail">正在检测...</td>
                                </tr>
                                <tr>
                                    <td>核心模块</td>
                                    <td><span id="core-status" class="layui-badge">检测中</span></td>
                                    <td id="core-detail">正在加载核心模块...</td>
                                </tr>
                                <tr>
                                    <td>表单组件</td>
                                    <td><span id="form-status" class="layui-badge">检测中</span></td>
                                    <td id="form-detail">正在检测表单组件...</td>
                                </tr>
                                <tr>
                                    <td>表格组件</td>
                                    <td><span id="table-status" class="layui-badge">检测中</span></td>
                                    <td id="table-detail">正在检测表格组件...</td>
                                </tr>
                                <tr>
                                    <td>layer组件</td>
                                    <td><span id="layer-status" class="layui-badge">检测中</span></td>
                                    <td id="layer-detail">正在检测layer组件...</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="layui-btn-container">
                            <button class="layui-btn layui-btn-normal" onclick="runTests()">重新检测</button>
                            <button class="layui-btn layui-btn-warm" onclick="testAllComponents()">测试所有组件</button>
                            <button class="layui-btn" onclick="location.href='index.html'">返回主页</button>
                        </div>
                        
                        <div id="test-results" style="margin-top: 20px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="lib/layui-v2.13.2/layui.js" charset="utf-8"></script>
    <script>
        function updateStatus(elementId, status, detail, success = true) {
            const statusElement = document.getElementById(elementId + '-status');
            const detailElement = document.getElementById(elementId + '-detail');
            
            statusElement.textContent = status;
            statusElement.className = success ? 'layui-badge layui-bg-green' : 'layui-badge layui-bg-red';
            detailElement.textContent = detail;
        }
        
        function runTests() {
            // 测试Layui版本
            try {
                const version = layui.v;
                if (version === '2.13.2') {
                    updateStatus('version', '成功', '当前版本：' + version + ' (升级成功)', true);
                } else {
                    updateStatus('version', '警告', '当前版本：' + version + ' (版本不一致)', false);
                }
            } catch (e) {
                updateStatus('version', '失败', 'Layui未正确加载：' + e.message, false);
            }
            
            // 测试核心模块
            layui.use(['jquery', 'element', 'form'], function() {
                try {
                    const $ = layui.jquery;
                    const element = layui.element;
                    const form = layui.form;
                    
                    if ($ && element && form) {
                        updateStatus('core', '成功', '核心模块加载完成 (jquery, element, form)', true);
                    } else {
                        updateStatus('core', '失败', '核心模块加载不完整', false);
                    }
                } catch (e) {
                    updateStatus('core', '失败', '核心模块加载错误：' + e.message, false);
                }
            });
            
            // 测试表单组件
            layui.use(['form'], function() {
                try {
                    const form = layui.form;
                    if (form) {
                        updateStatus('form', '成功', '表单组件加载成功', true);
                    } else {
                        updateStatus('form', '失败', '表单组件未加载', false);
                    }
                } catch (e) {
                    updateStatus('form', '失败', '表单组件错误：' + e.message, false);
                }
            });
            
            // 测试表格组件
            layui.use(['table'], function() {
                try {
                    const table = layui.table;
                    if (table) {
                        updateStatus('table', '成功', '表格组件加载成功', true);
                    } else {
                        updateStatus('table', '失败', '表格组件未加载', false);
                    }
                } catch (e) {
                    updateStatus('table', '失败', '表格组件错误：' + e.message, false);
                }
            });
            
            // 测试layer组件
            layui.use(['layer'], function() {
                try {
                    const layer = layui.layer;
                    if (layer) {
                        updateStatus('layer', '成功', 'layer组件加载成功', true);
                        layer.msg('Layer组件测试成功！');
                    } else {
                        updateStatus('layer', '失败', 'layer组件未加载', false);
                    }
                } catch (e) {
                    updateStatus('layer', '失败', 'layer组件错误：' + e.message, false);
                }
            });
        }
        
        function testAllComponents() {
            layui.use(['jquery', 'layer', 'form', 'table', 'element'], function() {
                const layer = layui.layer;
                const $ = layui.jquery;
                const form = layui.form;
                const table = layui.table;
                const element = layui.element;
                
                let results = '<h3>组件测试结果：</h3><ul>';
                
                // 测试各个组件
                try {
                    layer.msg('所有组件测试开始');
                    results += '<li>✅ Layer组件 - 正常</li>';
                } catch (e) {
                    results += '<li>❌ Layer组件 - 错误: ' + e.message + '</li>';
                }
                
                try {
                    if ($) results += '<li>✅ jQuery - 正常</li>';
                    else results += '<li>❌ jQuery - 未加载</li>';
                } catch (e) {
                    results += '<li>❌ jQuery - 错误: ' + e.message + '</li>';
                }
                
                try {
                    if (form) results += '<li>✅ Form组件 - 正常</li>';
                    else results += '<li>❌ Form组件 - 未加载</li>';
                } catch (e) {
                    results += '<li>❌ Form组件 - 错误: ' + e.message + '</li>';
                }
                
                try {
                    if (table) results += '<li>✅ Table组件 - 正常</li>';
                    else results += '<li>❌ Table组件 - 未加载</li>';
                } catch (e) {
                    results += '<li>❌ Table组件 - 错误: ' + e.message + '</li>';
                }
                
                try {
                    if (element) results += '<li>✅ Element组件 - 正常</li>';
                    else results += '<li>❌ Element组件 - 未加载</li>';
                } catch (e) {
                    results += '<li>❌ Element组件 - 错误: ' + e.message + '</li>';
                }
                
                results += '</ul>';
                document.getElementById('test-results').innerHTML = results;
                
                layer.msg('组件测试完成！');
            });
        }
        
        // 页面加载完成后自动运行测试
        window.onload = function() {
            setTimeout(runTests, 1000);
        };
    </script>
</body>
</html>